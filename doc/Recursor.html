<!doctype html public "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>

<head>
<meta http-equiv = "Content-Type" content = "text/html;charset=UTF-8">
<!-- Steal these colour values from JavaDocs. -->
<style type = "text/css">
	a:link,  a:visited { color: #4a6782; }
	a:hover, a:focus   { color: #bb7a2a; }
	a:active           { color: #4A6782; }
	tr:nth-child(even) { background: #dee3e9; }
	div {
		margin:  4px 0;
		padding: 0 4px 4px 4px;
	}
	table      { width: 100%; }
	td         { padding: 4px; }
	h3, h1 {
		color: #2c4557;
		background-color: #dee3e9;
		padding:          4px;
	}
	h3 {
		margin:           0 -4px;
		padding:          4px;
	}
</style>
<title>Recursor.c</title>
</head>

<body>

<h1>Recursor.c</h1>

<h2>make-index</h2>

<ul>
	<li><a href = "#preamble:">Description</a></li>
	<li><a href = "#license:">License</a></li>
</ul>

<div>

<h2><a id = "preamble:" name = "preamble:">Description</a></h2>

<p><code>Recursor</code> is the main part of <code>make-index</code>, a content management system that generates static content, (mostly <code>index.html</code>,) on all the directories rooted at the directory specified by <code>--directory</code> or <code>-d</code>. It is based on a template file, <code>.index.html</code> and <code>.newsfeed.rss</code>, which are changeable. Also included are files to summarize the directory structure for a <code>xml</code> site map, compatible with Google, and any <code>.news</code> for an <code>rss</code> feed.</p>

<p>There should be an <code>example</code> directory that has a bunch of files in it. Run <code>bin/make-index -d example/</code>; it should make a webpage out of the directory structure and <code>.index.html</code>, open <code>example/index.html</code> after running to see.</p>

<ul>
	<li>If the <code>.index.html</code> file exists in the <code>&lt;directory&gt;</code>, prints <code>index.html</code> recursively; overwrites any <code>index.html</code> on all the directories rooted at <code>&lt;directory&gt;</code>;</li>
	<li>if the <code>.sitemap.xml</code> file exists in <code>&lt;directory&gt;</code>, prints (and overwrites) an index called <code>sitemap.xml</code>;</li>
	<li>if the <code>.newsfeed.rss</code> file exists in <code>&lt;directory&gt;</code>, prints (and overwrites) to <code>newsfeed.rss</code> all the <code>.news</code> files (if there are any.)</li>
</ul>

<ul>
	<li>Treats <code>.d</code> as a description of the file without the <code>.d</code>; if this is an empty text-file or a zero-byte file, it skips over this file.</li>
	<li>treats <code>index.d</code> as a description of the directory;</li>
	<li>treats <code>content.d</code> as an in-depth description of the directory, replacing <code>index.d</code> when in the directory, when it exists;</li>
	<li>treats <code>.d.jpg</code> as a image that will go with the description;</li>
	<li>treats <code>.news</code> as a newsworthy item; the format of this file is ISO 8601 date (YYYY-MM-DD,) next line title;</li>
	<li>treats <code>.link</code> as a link with the href in the file.</li>
</ul>

<p><code>.index.html</code>, <code>.sitemap.xml</code>, <code>.newsfeed.rss</code>, see <code>Parser</code> for recognised symbols. Assumes <code>..</code> is the parent directory, <code>.</code> is the current directory, and <code>/</code> is the directory separator; works for UNIX, MacOS, and Windows. If this is not the case, the constants are in <code>Files.c</code>.</p>

</div>

<dl>
	<dt>Author:</dt>
	<dd>Neil</dd>
	<dt>Standard:</dt>
	<dd>POSIX.1</dd>
	<dt>Caveat:</dt>
	<dd>Don't have &lt;directory&gt; be an argument; just do it in the current. Borrow <code>Cdoc</code> parser for the <code>.d</code> files. (<code>lex</code> is pretty good.) Encoding is an issue; especially the newsfeed, which requires 7-bit. It's not robust; eg @(files){@(files){Don't do this.}}. Simplify the command line arguments.</dd>
</dl>

<div>

<h2><a id = "license:" name = "license:">License</a></h2>

<p>2000, 2012 Neil Edelman, distributed under the terms of the <a href = "https://opensource.org/licenses/GPL-3.0">GNU General Public License 3</a>.</p>

</div>

</body>

</html>
