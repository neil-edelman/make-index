<!doctype html public "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>

<head>
<meta http-equiv = "Content-Type" content = "text/html;charset=UTF-8">
<!-- Steal these colour values from JavaDocs. -->
<style type = "text/css">
	a:link,  a:visited { color: #4a6782; }
	a:hover, a:focus   { color: #bb7a2a; }
	a:active           { color: #4A6782; }
	tr:nth-child(even) { background: #dee3e9; }
	div {
		margin:  4px 0;
		padding: 0 4px 4px 4px;
	}
	table      { width: 100%; }
	td         { padding: 4px; }
	h3, h1 {
		color: #2c4557;
		background-color: #dee3e9;
		padding:          4px;
	}
	h3 {
		margin:           0 -4px;
		padding:          4px;
	}
</style>
<title>Parser.c</title>
</head>

<body>

<h1>Parser.c</h1>

<ul>
	<li><a href = "#preamble:">Description</a></li>
	<li><a href = "#summary:">Function Summary</a></li>
	<li><a href = "#fn:">Function Definitions</a></li>
	<li><a href = "#license:">License</a></li>
</ul>

<div>

<h2><a id = "preamble:" name = "preamble:">Description</a></h2>

<p>@title Parser</p>

<p>Parsing of strings. '&nbsp;' on a line by itself is recognized in ".newsfile.rss" and ".sitemap.xml" as a <code>&lt;head&gt;~&lt;body&gt;~&lt;tail&gt;</code>; there should be two of them.</p>

<p>Parsed in ".index.html",</p>

<ul>
	<li><code>@(content)</code> prints <code>content.d</code>, or, if it is missing, <code>index.d</code>;</li>
	<li><code>@(files)\{}</code> repeats for all the files in the directory the contents of the argument;</li>
	<li><code>@(htmlcontent)</code>;</li>
	<li><code>@(pwd)\{}</code> prints the directory, the argument is the separator; <em>eg</em>, <code>@(pwd)\{/}</code>;</li>
	<li><code>@(root)\{}</code>, like <code>@(pwd)</code>, except up instead of down;</li>
	<li><code>@(now)</code> prints the date and the time in UTC.</li>
</ul>

<p>Further parsed in <code>@(files){}</code> in ".index.html",</p>

<ul>
	<li><code>@(filealt) prints Dir or File; *</code>@(filedesc);</li>
	<li><code>@(filehref) prints the filename or the</code>.link<code>; *</code>@(fileicon) prints it's <code>.d.jpeg</code>, or if it is not there, <code>dir.jpeg</code> or <code>file.jpeg</code>;</li>
	<li><code>@(filename)</code> prints the file name;</li>
	<li><code>@(filesize)</code> prints the file size, if it exits;</li>
	<li><code>@(now)</code> prints the date and the time in UTC.</li>
</ul>

<p>Parsed in ".newsfeed.rss",</p>

<ul>
	<li><code>@(date)</code> prints the date on the news file;</li>
	<li><code>@(news)</code> prints the contents of the file (as a text file);</li>
	<li><code>@(newsname)</code> prints the filename of the news story;</li>
	<li><code>@(now)</code> prints the date and the time in UTC;</li>
	<li><code>@(title)</code> prints the second line in the {.news}.</li>
</ul>

<dl>
	<dt>Author:</dt>
	<dd>Neil</dd>
	<dt>Standard:</dt>
	<dd>C89/90</dd>
	<dt>Caveat:</dt>
	<dd>(<a href = "#fn:ParserParse">ParserParse</a>)</dd>
</dl>

</div>

<div>

<h2><a id = "summary:" name = "summary:">Function Summary</a></h2>

<table>

<tr><th>Modifiers</th><th>Function Name</th><th>Argument List</th></tr>

<tr><td align = right>struct Parser *</td><td><a href = "#fn:Parser">Parser</a></td><td>str</td></tr>

<tr><td align = right>void</td><td><a href = "#fn:Parser_">Parser_</a></td><td>p_ptr</td></tr>

<tr><td align = right>void</td><td><a href = "#fn:ParserRewind">ParserRewind</a></td><td>p</td></tr>

<tr><td align = right>int</td><td><a href = "#fn:ParserParse">ParserParse</a></td><td>p, f, invisible, fp</td></tr>

</table>

</div>

<div>

<h2><a id = "fn:" name = "fn:">Function Definitions</a></h2>

<div>

<h3><a id = "fn:Parser" name = "fn:Parser">Parser</a></h3>

<p><code>struct Parser *<strong>Parser</strong>(char *const <em>str</em>)</code></p>

<dl>
	<dt>Return:</dt>
	<dd>Creates a parser for the string, <code>str</code>.</dd>
</dl>

</div>

<div>

<h3><a id = "fn:Parser_" name = "fn:Parser_">Parser_</a></h3>

<p><code>void <strong>Parser_</strong>(struct Parser **const <em>p_ptr</em>)</code></p>

<dl>
	<dt>Parameter: <em>p_ptr</em></dt>
	<dd>A pointer to the <code>Parser</code> that's to be destucted.</dd>
</dl>

</div>

<div>

<h3><a id = "fn:ParserRewind" name = "fn:ParserRewind">ParserRewind</a></h3>

<p><code>void <strong>ParserRewind</strong>(struct Parser *<em>p</em>)</code></p>

<p>Resets the parser, <code>p</code>.</p>

</div>

<div>

<h3><a id = "fn:ParserParse" name = "fn:ParserParse">ParserParse</a></h3>

<p><code>int <strong>ParserParse</strong>(struct Parser *<em>p</em>, struct Files *const <em>f</em>, int <em>invisible</em>, FILE *<em>fp</em>)</code></p>

<p>Parse, called recursively.</p>

<dl>
	<dt>Parameter: <em>f</em></dt>
	<dd>Called in the handler to <code>ParserWidget</code>.</dd>
	<dt>Parameter: <em>invisible</em></dt>
	<dd>Binary -- no output.</dd>
	<dt>Parameter: <em>fp</em></dt>
	<dd>Output.</dd>
	<dt>Caveat:</dt>
	<dd>This fn needs rewriting; messy. Invisible, hack.</dd>
</dl>

</div>

</div>

<div>

<h2><a id = "license:" name = "license:">License</a></h2>

<p>2000, 2012 Neil Edelman, distributed under the terms of the <a href = "https://opensource.org/licenses/GPL-3.0">GNU General Public License 3</a>.</p>

</div>

</body>

</html>
